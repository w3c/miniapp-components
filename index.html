<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="color-scheme" content="light dark"/>
  <title>MiniApp Components</title>
  <script defer class="remove" src="https://www.w3.org/Tools/respec/respec-w3c"></script>
  <script class="remove">
    var respecConfig = {
      specStatus: "CG-DRAFT",
      copyrightStart: "2022",
      edDraftURI: "https://w3c.github.io/miniapp-components",
      editors: [
        {
          name: "Martin Alvarez-Espinar",
          companyURL: "https://www.huawei.com",
          company: "Huawei",
          w3cid: 125049,
        },
        {
          name: "Zitao Wang",
          companyURL: "https://www.huawei.com",
          company: "Huawei",
          w3cid: 124483,
        },
      ],
      group: "cg/miniapps",
      github: {
        repoURL: "https://github.com/w3c/miniapp-components",
        branch: "main",
      },
      localBiblio: {
        "CSS-SNAPSHOT": {
          title: "CSS Snapshot",
          href: "https://www.w3.org/TR/CSS/"
        },
      },
      a11y: true,
    };
  </script>
  <style>        
    table.elements {
      border-collapse: collapse;
      width: 100%;
      background: #fff;
      font-size: 0.8rem;
      margin-top: 1rem;
      position: relative;
    }    
    table.elements td,
    table.elements th {
      padding: 0.4em 0.4em;
      text-align: left;
      border-right: 1px solid rgba(17, 101, 145, 0.4);
      border-left: 1px solid rgba(17, 101, 145, 0.4);
    }
    table.elements td code {
      font-weight: bold;
    }
    table.elements tr:last-child td,
    table.elements tr:last-child th {
      border-bottom: 1px solid rgba(17, 101, 145, 0.4);
    }
    table.elements thead th,
    table.elements thead th a, 
    table.elements thead th a:hover, 
    table.elements thead th a:active, 
    table.elements thead th a:link, 
    table.elements thead th a:visited{
      font-weight: bold;
      color: #fff;
      white-space: nowrap;
      text-align: center;
      padding-top: 1.0em;
      padding-bottom: 1.0em;
      top: 0;
      background-color: #034575;
      position: sticky;
      min-width: 120px;
    }
    table.elements tbody tr:nth-child(2n-1) {
      background-color: #fafafa;
      transition: all .125s ease-in-out;
    }          
    table.elements tbody tr td:nth-child(2),
    table.elements tbody tr td:nth-child(3),
    table.elements tbody tr td:nth-child(4),
    table.elements tbody tr td:nth-child(5) {
      width: 15vw;
    }
  </style>  
</head>

<body data-cite="MINIAPP-PACKAGING">

  <section id="abstract">
    <p>MiniApp Components are the building blocks to creating MiniApp Pages. These components encapsulate functionality, data,
      and styles, enabling developers to create custom and reusable items that can be combined to develop MiniApps. This
      specification aims to specify a set of common practices to define [=MiniApp Components=] that allow developers to build
      similar user interfaces across MiniApp platforms efficiently and provide a consistent user experience.</p>
  </section>

  <section id="sotd">
  </section>

  <section id="sec-introduction">
    <h2>Introduction</h2>

    <p>[=MiniApp Components=] are the building blocks to creating
      <a href="https://www.w3.org/TR/miniapp-packaging/#dfn-page"
        data-link-type="dfn">MiniApp Pages</a>. These components encapsulate functionality, data, and styles, enabling developers to create custom
        and reusable items that can be combined to develop MiniApps. MiniApps include essential elements like page containers,
        textual and multimedia content, and other interactive features like forms.</p>

    <p>To align MiniApps and Web applications, MiniApps may be defined using Web resources (i.e., HTML, CSS,
      and scripts) as described in [[MINIAPP-PACKAGING]]. Despite this, traditionally, MiniApp implementations offer specific
      non-standard features and mechanisms facilitating the development and implementation of the MiniApp Components.</p>

    <p>Although MiniApp Components share the same concept as Web Components, their capabilities and development features differ.
      The main differences are motivated by the architecture of the existing implementations along the MiniApp ecosystem
      following the MVVM pattern, based on components developed through domain-specific markup languages and without access
      to the standard DOM.</p>

    <p>To avoid overlap with Web Components, also supported by MiniApp user agents, this specification aims to be an informative
      reference and is not intended to be a formal standard. Thus, it aims to specify a set of common practices to define
      [=MiniApp Components=] that allow developers to build similar user interfaces across MiniApp platforms efficiently
      and provide a consistent user experience.</p>

    <section id="conformance">
    </section>
  </section>

  <section id="sec-basics">
    <h2>Component Basics</h2>

    <section id="sec-pages-components">
      <h3>MiniApp Pages and Components</h3>
      <p>
        A <dfn data-lt="component">MiniApp Component</dfn> is a custom MiniApp element with encapsulated functionality, data, and styles that
        can be reused in <a href="https://www.w3.org/TR/miniapp-packaging/#dfn-page" data-link-type="dfn">MiniApp Pages</a>.
      </p>
      <p data-cite="HTML">
        Each [=component=] is defined by three documents: an <a href="#sec-templating">HTML resource</a>, defining the structure and static content of the component; a <a href="#sec-stylesheets">style sheet</a> with the styles and appearance configuration for rendering; and a <a href="#sec-scripting">script resource</a> to control de business logic of the component. A component may be composed of other sub-components (stored within the package) and predefined <a href="#sec-elements">built-in elements</a>, similar to [=HTML Elements=].
      </p>
      <p>
        Components and subcomponents are organized hierarchically in a tree. Although the functions and styles are encapsulated, a component may communicate with its relative nodes using <a href="#sec-events">events</a>. Developers may configure the <a href="https://www.w3.org/TR/miniapp-packaging/#dfn-page" data-link-type="dfn">Pages</a> of the app using the manifest document [[MINIAPP-MANIFEST]], pointing to the specific component associated with the page.   
      </p>
      <figure id="img-miniapp-pages-components">
        <img alt="Components structure of a MiniApp (pages and components)" src="https://w3c.github.io/miniapp-packaging/images/miniapp-pages-components.svg" width="600">
        <figcaption>Structure of a MiniApp including components and subcomponents</figcaption>
      </figure>
    </section>

    <section id="sec-interface">
      <h3>MiniApp Interface</h3>
      <p>
      </p>
      <div class="ednote">
        Formal definition of the interface?
      </div>
    </section>
  </section>

  <section id="sec-templating" data-cite="MINIAPP-LIFECYCLE">
    <h2>Templating</h2>
    <p>
      MiniApps have an advanced one-way data binding, with a <a href="https://mustache.github.io/">Mustache-based</a> templating mechanism, to reduce code redundancy and maximize maintenance efficiency.
    </p>
    <p>
      Component templates are defined in the primary HTML resource associated with the component. The templating implementations are based on DOM, with XML or HTML elements and special attributes.
    </p>
    <p>
      Every component instance is defined as a data object with properties and methods bound to the template. The object that contains the component's data and the business logic, managed by the [=Document/logic layer=], communicates the template instance (in the [=Document/view layer=]) of the changes produced on the data properties to proceed with the view update. 
    </p>

    <section id="sec-data-interpolation">
      <h3>Content Interpolation</h3>
      <p>
        Component's templates support text interpolation using the <a href="https://mustache.github.io/">Mustache</a> syntax through double curly braces (`{{}}`). The component's properties, defined in a <a href="#sec-scripting">scripting resource</a> and managed by the [=Document/logic layer=], are bound to the corresponding component's template file, described in the HTML resource that runs on the [=Document/view layer=]. 
      </p>
      <p>
        The templating mechanism replaces mustache tags with the value of the properties defined under the same name in the component.  
      </p>
      <pre class="example" title="Template with data interpolation">&lt;!-- my-component.html --&gt;
&lt;div&gt;{{foo}}&lt;/div&gt;

...

// my-component.js
export default {
  props: {
    foo: 'bar'
  }
}
      </pre>
      <p>
        In the previous example, the mustache element `{{foo}}` is replaced with the textual value of the `foo` property on the corresponding component instance. The value of this mustache variable will be updated during the execution when the `foo` property changes. The process can be summarized as follows:
      </p>
      <ol>
        <li>The system identifies the component's properties and methods associated with the mustache variables in the template instance.</li>
        <li>It monitors changes in the component's object status.</li>
        <li>Once one monitored variable changes (in the [=Document/logic layer=]), the update is communicated to the template instance (in the [=Document/view layer=]).</li>
      </ol>      
    </section>
  </section>

  <section id="sec-declaration" data-cite="HTML">
    <h2>Component Declaration</h2>
    <p>
      MiniApp user agents provide a series of essential built-in components (also called native elements or native components) equivalent to the standard [=HTML Elements=]. These built-in elements allow developers to create customized components that can be instantiated and re-used by other MiniApp components. 
    </p>
    <p>
      Similarly to the standard [=HTML Elements=], developers may use the MiniApp built-in elements to create and customize components. A user-defined component requires three main resources [[MINIAPP-PACKAGING]]:
    </p>
    <ul>
       <li>An HTML resource (e.g., `my-component.html`) to describe the component structure and static content.</li>
       <li>A style sheet (e.g., `my-component.css`) to define the styles of the component (it can be blank).</li>
       <li>A scripting resource (e.g., `my-component.js`) that describes the component's business logic and behavior.</li>
    </ul>
    <p>
      Developers use these HTML resources to define the structure and static content of the component, using the built-in elements and other custom components existing in the package. 
    </p>
    <p>
      A MiniApp component encapsulates its logic and stylesheet. So, the default style sheet and scripts only affect the elements and components defined in the HTML resource. Still developers may use other scripts and style sheets upon explicit declaration. 
    </p>
    <p data-cite="MINIAPP-LIFECYCLE">
      MiniApp user agents specify a mechanism to send data from the component's scripting resource (e.g., `my-component.js`) run in the [=Document/Logic layer=] to the components and elements in the [=Document/View layer=] during runtime execution. User agents interpret the scripting resources as ECMAScript Modules (ESM) that use the `export` declaration in the source file. This scripting resource associated with the main HTML resource is expected to have an anonymous `export default` declaration that contains the component <a href="https://262.ecma-international.org/13.0/#sec-object-initializer">object initializer</a>, which includes callback functions used in events and data properties used in events accessible from the [=Document/View layer=]. They may also have other auxiliary variables, constants, and methods needed for the component's logic.   
    </p>
    <pre class="example" title="Component object initializer"><code>// my-component.js

export default {
  // data attributes 
  // properties
  // event listeners
  // methods 
}
    </code></pre>

    <section id="sec-properties">
      <h3>Component Data, Properties and Methods</h3>
      <p data-cite="MINIAPP-LIFECYCLE">
        The scripting resources (e.g., `my-component.js`) use the `export` keyword to expose an object with the component's data, properties, and methods, making them available to the [=Document/View layer=].     
      </p>
      <p>
        Components may have <strong>data attributes</strong>. These attributes are variables that store information specific to that component and usually hold component states that can influence the logic and UI of the application. These attributes are generally defined directly as part of the component's definition.
      </p>
      <pre class="example" title="Component data attribute declaration"><code>// my-component.js

export default {
  color: 'Red',
  title: 'My component'
}
      </code></pre>      
      <p>
        A <strong>property</strong> is an attribute that can be assigned to the component when it is instantiated, allowing for customization and dynamic behavior. Properties can be considered variables initialized when passed down to the component and can hold a value and be updated as needed. Properties are usually defined by the key `props`, whose value is an object of key-value properties. The key in the object determines the property's name and its value is an object that defines the <a href="https://tc39.es/ecma262/#sec-ecmascript-data-types-and-values">data type</a> (`type` member) and value (`value` member).  
      </p>
      <pre class="example" title="Component property declaration"><code>// my-component.js

export default {
  props: {
    foo: {
      type: String,
      value: 'bar'
    }
  }
}
      </code></pre>
      <p>
        The definition could avoid the data type, allowing any.  
      </p>
      <pre class="example" title="Component property declaration without type"><code>// my-component.js

export default {
  props: {
    foo: {
      value: 'bar'
    }
  }
}
      </code></pre>
      <p>
        Developers can also define the property's name without initializing it with a default value. This could be useful if the property is set up within the methods of the component. Properties could also be defined as a list of names.
      </p>
      <pre class="example" title="Declaration of component properties in an array"><code>// my-component.js

export default { 
  props: ['foo','button','title'],
}
      </code></pre>
      <pre class="example" title="Example of component defining a child component with properties"><code>// parent-component.html
&lt;my-comp button="Next" title="Item #1"&gt;
      </code></pre>
      
      <p>
        Internal <strong>methods and callback functions</strong> of a component are also defined in the object initializer of the primary scripting resource. A property key represents the method's name, and the value includes its definition.
      </p>
      <pre class="example" title="Declaration of a component callback function"><code>// my-component.js

export default {
  loadMore: function(event) {
    console.log(event);
  }
}     </code></pre>

      <section id="sec-methods">
        <h4>Built-in Methods</h4>
        <p data-cite="MINIAPP-LIFECYCLE">
          Although they are similar, MiniApp components do not implement the methods and attributes of the {{HTMLElement}} interface. The decoupling of [=Document/Logic layer=] and [=Document/View layer=] causes the logic of the component instance cannot directly access the DOM of the page. MiniApp user agents solve this challenge with specific interfaces that include built-in properties and methods exposed on the component public instance (i.e., accessible through `this`) for the following purposes:
        </p>
        <ul>
          <li>Access/add/modify a data property.</li>
          <li>Get the root component instance of the current component tree.</li>
          <li>Get the parent component instance.</li>
          <li>Get a child component instance based on its identifier.</li>
          <li>Support communication between relatives. Components trigger events that can be propagated to their parents, along with their associated data. The parent component gets the  child's instance, accessing its data and methods.</li>          
        </ul>
      </section>
      <div class="ednote">
        How to register a component? Just with the manifest?
      </div>
    </section>

  </section>

  <section id="sec-reuse">
    <h2>Component Reuse</h2>
    <p>
      A component may use other custom components registered and defined within the package. For that, developers must import the custom component in the parent component declaration. The imported component is exposed to the component template. It will be available as another tag in the template, identified by a unique key.
    </p>
    <pre class="example" title="Import of custom component"><code>&lt;!-- my-component.html --&gt;

&lt;import src="./cool-button" name="cool-button" /&gt;

&lt;div&gt;
  &lt;cool-button&gt;&lt;/cool-button&gt;
&lt;/div&gt;</code></pre>
    <p data-cite="HTML">
      Like in Web Components, MiniApp components may use [^slot^] elements as placeholders to pass content from the parent to the child component.
    </p>  
    <pre class="example" title="Use of slot elements inside components"><code>&lt;!-- my-component.html -&gt;
&lt;div class="item"&gt;  
   &lt;slot name="title"&gt;&lt;/slot&gt; 
&lt;/div&gt;</code></pre>
    <div class="ednote">
      Access to component nodes?
    </div>
  </section>

  <section id="sec-events">
    <h2>Component Events</h2>
    <p>
      As defined in [[UIEVENTS]], an <a href="https://www.w3.org/TR/uievents/#event" data-link-type="dfn">event</a> is the representation of an occurrence (such as a mouse click on the presentation of an element, the removal of a child node from an element, or any number of other possibilities) that is associated with its <a href="https://www.w3.org/TR/uievents/#event-target" data-link-type="dfn">event target</a>. Each event is an instantiation of one specific <a href="https://www.w3.org/TR/uievents/#event-type" data-link-type="dfn">event type</a>.
    </p>
    <p>
      MiniApp user agents have a dual-thread architecture, decoupling the logic and rendering engines. Therefore, the logic layer does not have access to the complete DOM tree of the document in the rendering layer, and the event targets (nodes in the rendering layer) do not always support the <a href="https://dom.spec.whatwg.org/#introduction-to-dom-events">standard DOM Events</a> model as defined in [[DOM]]. MiniApp agents usually provide a customized event system to deal with events on the virtual DOM nodes.
    </p>
    <section id="sec-events-binding">
      <h3>Event Handlers</h3>
      <p>
        Elements in components can have event handlers specified. An event handler is composed of a value, usually an internal reference, and a listener, a callback function responsible for processing the algorithm for that event handler. In MiniApp components, the event handlers are exposed using event handler content attributes. These handlers are exposed through a name that starts with a specific keyword (`on`, `bind`, or others), followed by the event type identifier.
      </p>
      <pre class="example"><code>&lt;!-- my-component.html --&gt;
  &lt;text onclick="loadMore"&gt;example&lt;/text&gt; 
    &lt;!-- or --&gt;
  &lt;view bindtap="loadMore"&gt;example&lt;/view&gt;
</code></pre>
      <p data-cite="DOM">
        Due to the decoupled architecture, MiniApp elements do not implement the {{EventTarget}} interface, so they do not implement the {{EventTarget/addEventListener()}} function. Therefore, event binding is only performed statically using handler content attributes on the component elements. The callback function associated with the event handler is specified in the scripting resource in scope, as a member of the exported anonymous object.
      </p> 
      <pre class="example"><code>// my-component.js

  export default {
    loadMore(event) {
      console.log(event);
    }
  }
      </code></pre>
      <p>
        Likewise, developers can also define the callback functions to process the <a href="#sec-lifecycle">lifecycle events</a>.
      </p>
      <pre class="example"><code>// my-component.js

  export default {
    oncreated() {
      console.log('Component created!');
    },
    onready() {
      console.log('Component is ready!');
    }
  }
</code></pre>
    </section>
    <section id="sec-events-types">
      <h3>Types of Events</h3>
      <p>
        MiniApp user agents implement support for a common set of event handlers supported by all their component elements, similar to HTML. However,  MiniApps have been traditionally implemented in native environments, not focused on the Web, so the names of the types might vary. Also, MiniApps user agents usually implement different event types by default.
      </p>
      <p>
        The following list contains the handlers event types, supported by all MiniApp component elements:  
      </p>
      <dl>
        <dt>`touchstart`</dt>
        <dd>Like the <a href="https://www.w3.org/TR/touch-events/#dfn-touchstart" data-link-type="dfn">touchstart</a> event type defined in [[TOUCH-EVENTS]], this event is dispatched on the topmost component (event target) indicated by the pointer when the user places a <a data-link-type="dfn" href="https://w3c.github.io/touch-events/#dfn-touch-point">touch point</a> on the touch surface.</dd>
        <dt>`touchmove`</dt>
        <dd>Like the <a href="https://www.w3.org/TR/touch-events/#dfn-touchmove" data-link-type="dfn">touchmove</a> event type defined in [[TOUCH-EVENTS]], this event is dispatched on the topmost component (event target) indicated by the pointer when the user moves a <a data-link-type="dfn" href="https://w3c.github.io/touch-events/#dfn-touch-point">touch point</a> along the touch surface.</dd>
        <dt>`touchcancel`</dt>
        <dd>Like the <a href="https://www.w3.org/TR/touch-events/#dfn-touchcancel" data-link-type="dfn">touchcancel</a> event type defined in [[TOUCH-EVENTS]], this event is dispatched on the topmost component (event target) indicated by the pointer when the <a data-link-type="dfn" href="https://w3c.github.io/touch-events/#dfn-touch-point">touch point</a> has been disrupted in an implementation-specific manner.</dd>
        <dt>`touchend`</dt>
        <dd>Like the <a href="https://www.w3.org/TR/touch-events/#dfn-touchend" data-link-type="dfn">touchend</a> event type defined in [[TOUCH-EVENTS]], this event is  dispatched on the topmost component (event target) indicated by the pointer when the user removes a <a data-link-type="dfn" href="https://w3c.github.io/touch-events/#dfn-touch-point">touch point</a> from the touch surface, also including cases where the touch point physically leaves the touch surface.</dd>
        <dt>`click` or `tap`</dt>
        <dd>Like the <a href="https://www.w3.org/TR/uievents/#event-type-click" data-link-type="dfn">click</a></th> event type defined in [[UIEVENTS]], this event is dispatched on the topmost event target indicated by the pointer when the user presses down and releases the primary pointer button or otherwise activates the pointer in a manner that simulates such an action.</dd>
        <dt>`longtap` or `longpress`</dt>
        <dd>The `longpress` or `longtap` event type is dispatched on the topmost component (event target) indicated by the pointer when the user presses down, holds for a specific period, and releases the primary pointer button or otherwise activates the pointer in a manner that simulates such an action.</dd>      
      </dl>
      <p class="note">
        The minimum value of the longpress or longtap period may vary depending on the implementation (e.g., <a href="https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/view/ViewConfiguration.java#77">Android's default timeout is 400 ms</a>). Some platforms may allow developers to change the value by default.
      </p>      
    </section>
  </section>

  <section id="sec-scripting">
    <h2>Scripting Resources</h2>
    <p>
      MiniApp user agents support scripting resources to define the business logic and operation of the components. Although the aim of this specification is not to recommend a specific scripting language, the document considers ECMAScript (broadly known as JavaScript) [[ECMASCRIPT]] as the scripting language by default.

    </p>
    <p>
      As indicated in [[MINIAPP-PACKAGING]], each MiniApp component has a scripting file (with the `.js` extension). Since each component has its own scope, the functions and variables defined in the scripting file have global scope across the entire component, but they are isolated from the rest of the MiniApp components.     
    </p>
    <p>
      Scripts in components support module management. Modules have an independent scope, so the elements defined in a module are private by default and invisible to other modules. The exposition of the concrete module variables or functions MUST be explicitly made through the export declarations. Only local modules (i.e., hosted in the same package) MAY be imported.
    </p>
    <p data-cite="HTML">
      HTML resources (with the .html extension) MAY import local scripts, such as auxiliary libraries shared by the MiniApp components. These script documents SHOULD be hosted in the `/common` directory as defined in [[MINIAPP-PACKAGING]], so they will be available to any component in the package. As in the case of scripting modules, only local scripts (i.e., hosted in the same package) will be accessible to the components. Developers MAY include any scripting resource hosted in the same package from the HTML, using the `script` element, equivalent to [^script^] in HTML, with the [^script/src^] attribute to specify the URI of the document to import. The functions and variables of the imported script will have a limited scope across the entire component.
    </p>
    <pre class="example" title="Scripting modules imports"><code>// Static import
import utils from '../common/utils.js'

// dynamic import using require()
const utils = require('/common/utils.js')

// dynamically using import()
const utils = async import('/common/utils.js')
    </code></pre>

    <pre class="example" title="Loading scripts from HTML"><code>&lt;script src="../common/utils.js"&gt;&lt;script&gt;</code></pre>
    
    <section id="sec-scripting-constraints">
      <h3>Conformance of scripting resources</h3>

      <p>The script language in MiniApp packages is not restricted to ECMAScript (JavaScript). Still, this document uses it as a reference to illustrate the features that MUST be implemented and supported by MiniApps user agents.</p>

      <ul class="conformance" data-cite="HTML">
        <li>User agents MUST NOT allow the <a href="https://tc39.es/ecma262/#sec-eval-x">eval()</a> function in scripts to prevent security risks.</li>
        <li>Likewise, the {{WindowOrWorkerGlobalScope/setTimeout()}} and {{WindowOrWorkerGlobalScope/setInterval()}} functions MUST only support the first parameter as a callback function, preventing the execution of code dynamically.</li>
        <li>User agents MUST NOT allow the creation of functions dynamically.</li>
        <li>Each script module has its own independent scope.</li>
        <li>Only modules and scripts included within the same package could be imported. No external scripts can be loaded.</li>
      </ul>
    </section>

    <section id="sec-custom-scripts">
      <h3>Custom scripting resources</h3>

      <p>Some MiniApp user agents MAY support custom scripting formats to assist developers in building user interfaces. These formats are usually subsets of ECMAScript, restricted to only variables and functions that can be directly imported as a module and used from the rendering templates. Specifications vary depending on the implementation, and they use specific file extensions to identify the resource type.</p>

    <pre class="example" title="Baidu Smart Mini Programs and Alipay Mini Programs use SJS (Safe/Subset JavaScript) resources, identified by the `.sjs` file extension"><code>  // pages/index/foo.sjs
const message = 'hello sjs';
const format = num => num.toFixed(2);
export default {
  message,
  format
};</code></pre>

<pre class="example" title="Baidu Smart Mini Programs and Alipay Mini Programs use &lt;import-sjs&gt; element to import the module"><code>&lt;!-- pages/index/index.axml --&gt;

&lt;import-sjs from="./foo.sjs" name="utils" /&gt;

&lt;view&gt;{{utils.message}}&lt;/view&gt;
&lt;view&gt;{{utils.format(3.14159)}}&lt;/view&gt;</code></pre>
    </section>

  </section>

  <section id="sec-stylesheets">
    <h2>Styling</h2>
    <p>
      MiniApp user agents support CSS profiles based on the standard specifications defined by the CSS Working Group Snapshot [[CSS-SNAPSHOT]]. Style sheets of MiniApp components follow the CSS recommendations for syntax, selectors, rules, media queries, fonts, and other elements described in [[CSS-SNAPSHOT]] to specify the presentation of the components.
    </p> 
    <p>
      MiniApp user agents are not expected to implement full support of CSS. Instead, they MAY define specific CSS profiles with subsets of CSS properties, selectors, colors, rules, and other CSS specifications, aiming to simplify the development process and meet all their concrete requirements. 
    </p>  
    <p>
      Every MiniApp component has a style sheet (with the `.css` extension) associated by default. Developers MAY include additional style sheets to reuse common styles among the components (e.g., styles for buttons or dialogs). The shared style sheets SHOULD be hosted in the <a href="https://www.w3.org/TR/miniapp-packaging/#common-directory">`/common`</a> directory in the package.
    </p>
    <p>
      Developers may use the <a href="https://www.w3.org/TR/css-cascade-4/#at-ruledef-import" data-link-type="dfn">@import</a> rule to import style rules from other style sheets. If an <a href="https://www.w3.org/TR/css-cascade-4/#at-ruledef-import" data-link-type="dfn">@import</a> rule refers to a valid style sheet hosted locally in the package, user agents treat the imported style sheet as if its contents were written in place of the @import rule defined in [[CSS-CASCADE-4]].
    </p>
    <pre class="example" title="Import of style sheet from another style sheet"><code>/** scoreboard.css **/
@import  "../common/buttons.css";

.checkout  {
  color: yellow; 
}</code></pre>


    <p data-cite="HTML">
      Developers MAY also use the `style` element, equivalent to the [^script^] HTML element, to include CSS declarations in the primary HTML resource of the component.  

    </p>
    <pre class="example" title="Import of style sheet from the HTML document"><code>&lt;!-- scoreboard.html --&gt;
&lt;style src="/common/base.css"&gt;&lt;/style&gt;

&lt;style&gt;
  @import '/common/base.css';
  .impact {
    color: red;
  }
&lt;/style&gt;</code></pre>

    <p data-cite="HTML">
      Developers MAY define inline styles on specific visual elements of the component using the `style` attribute, equivalent to the [^html-global/style^] HTML common attribute.  
    </p>
    <pre class="example" title="Inline style declaration"><code>&lt;!-- scoreboard.html --&gt;
  &lt;div style="background-color:yellow;"&gt;
    This is a div
  &lt;&gt;</code></pre>

  </section>

  <section id="sec-lifecycle">
    <h2>Component Lifecycle</h2>
    <p>
      The lifecycle of a component refers to the process from its creation to its destruction. Every MiniApp component implements a collection of lifecycle callbacks triggered at the different stages of the component lifespan. As described in [[MINIAPP-LIFECYCLE]], MiniApp pages and components are rendered on the [=Document/View layer=], while the events involving the lifecycle management are processed on the [=Document/Logic layer=] of the user agent. 
    </p>
    
    <p data-cite="ECMASCRIPT">
      The component lifecycle callbacks are `created`, `attached`, `ready`, `detached`, `show`, and `hide`. The corresponding values are either a Web IDL {{Function}} callback function type value or `null`. By default, the value of each entry is `null`. 
    </p>
    <dl>
      <dt>`created`</dt>
      <dd>Callback function that indicates when a component is created in the system. This callback is triggered when a custom component is first created but not necessarily attached to the page. This callback, triggered only once, is usually used to initialize the component's properties.</dd>
      <dt>`attached`</dt>
      <dd>This callback is triggered when the component, already created, is attached to the document tree of a page. It is usually used for initializing the data for display, such as loading images and starting animations.</dd>
      <dt>`ready`</dt>
      <dd>Once a custom component is attached to the page document tree, the user agent renders the component in the [=Document/View layer=], performing the calculations and adjustment of the size and the position of the component layout and its contents. This callback is triggered after the layout calculation is complete and ready to be rendered.</dd>
      <dt>`detached`</dt>
      <dd>This callback is triggered when the node of a custom component is removed from the page document tree. It is usually used to stop animations or halt asynchronous executions.</dd>
      <dt>`show`</dt>
      <dd>This callback is triggered once the user agent renders the component to the user.</dd>
      <dt>`hide`</dt>
      <dd>This callback is triggered when the component is hidden from the user.</dd>
    </dl>  
    <div class="note" title="Differences between MiniApp Components and Web Components">
      <p>
        There are some differences between HTML Custom Elements and MiniApp component lifecycles:
      </p>
      <ul>
        <li>The `attached` and `detached` callbacks correspond to the `connectedCallback` and `disconnectedCallback` functions in standard Custom Elements, respectively, with the same functionality.</li>

        <li>MiniApp user agents do not support the migration of components in the document scope. Therefore, there is no `adopted` state in MiniApp components.</li>
        <li>MiniApp components have `created` and `ready` states with no standard equivalence. These callbacks are defined to notify changes in the creation status between the two main layers, the [=Document/Logic layer=] and the [=Document/View layer=]), running in separate threads.</li>
        <li>MiniApps do not support HTML Custom Elements' `attributeChangedCallback`. This callback is triggered when any attribute of a custom element changes, including adding, deleting, and updating. As shown in the <a href="#sec-templating">templating section</a>, the MiniApp framework only supports unidirectional data binding and cannot directly interact with the DOM. Therefore, any change in the DOM attribute cannot trigger any similar event.</li>
      </ul> 
    </div>
    <aside class="example" title="Lifecycle events of a MiniApp component">
      <p>
        Once the user agent starts the execution and rendering of a component in a page:
      </p>
      <ol>
        <li>The component is `created` in the system. The callback initializes the properties and data under the scope of the component. The initialization is performed from the scripting file (with `.js` extension) of the component.</li>
        <li>The node of the component is inserted into the page document tree, triggering the `attached` callback.</li>
        <li>The user agent analyzes the layout, calculating and adjusting the size and position of its elements and contents.</li>
        <li>Once the user agent completes the component's rendering, the `ready` event is triggered.</li>
      </ol>
    </aside>
  </section>

  <section id="sec-accessibility" class="informative">
    <h2>Accessibility Considerations</h2>
    <p></p>
  </section>

  <section id="sec-security" data-cite="PERMISSIONS">
    <h2>Security Considerations</h2>
    <p></p>
  </section>

  <section id="sec-privacy">
    <h2>Privacy Considerations</h2>
    <p></p>
  </section>

  <section id="sec-elements" class="appendix">
    <h2>MiniApp Elements</h2>
    <p>
      Although using standard HTML elements is recommended, some MiniApp user agents implement HTML-based domain-specific languages that do not follow the standards. Most elements have standard semantic equivalences or <a href="https://web.dev/patterns/components/">can be implemented using standards</a>.
    </p>
    <table class="elements">
      <thead>
        <tr>
          <th scope="col">Feature</th>
          <th scope="col">W3C <abbr title="Recommendation">Rec.</abbr></th>
          <th scope="col"><a href="https://www.quickapp.cn/" hreflang="zh-CN">QuickApp (Xiaomi, Huawei)</a></th>
          <th scope="col"><a href="https://docs.alipay.com/mini/developer/" hreflang="zh-CN">Alipay Mini Program</a></th>
          <th scope="col"><a href="https://smartprogram.baidu.com/developer/index.html" hreflang="zh-CN">Baidu Smart Mini Program</a></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th scope="row">Block container</th>
          <td><code>&lt;div&gt;</code></td>
          <td><code>&lt;div&gt;</code></td>
          <td>
            <details>
              <summary>
                  <code>&lt;view&gt;</code>
              </summary>
              <code>&lt;view&gt;</code>, <code>&lt;scroll-view&gt;</code>, <code>&lt;movable-view&gt;</code>,
              <code>&lt;movable-area&gt;</code>
            </details>
          </td>
          <td>
            <details>
              <summary>
                  <code>&lt;view&gt;</code>
              </summary>
              <code>&lt;view&gt;</code>, <code>&lt;scroll-view&gt;</code>, <code>&lt;movable-view&gt;</code>,
              <code>&lt;movable-area&gt;</code>
            </details>
          </td>
        </tr>
        <tr>
          <th scope="row">Inline container</th>
          <td><code>&lt;span&gt;</code></td>
          <td><code>&lt;span&gt;</code></td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <th scope="row">Stacking container</th>
          <td></td>
          <td><code>&lt;stack&gt;</code></td>
          <td>
            <details>
                <summary>
                    <code>&lt;cover-view&gt;</code>
                </summary>
                <code>&lt;cover-view&gt;</code>, <code>&lt;cover-image&gt;</code>
            </details>            
          </td>
          <td>
            <details>
                <summary>
                    <code>&lt;cover-view&gt;</code>
                </summary>
                <code>&lt;cover-view&gt;</code>, <code>&lt;cover-image&gt;</code>
            </details>            
          </td>
        </tr>
        <tr>
          <th scope="row">Slideshow (carousel)</th>
          <td></td>
          <td><code>&lt;swiper&gt;</code></td>
          <td><code>&lt;swiper&gt;</code></td>
          <td>
            <details>
                <summary>
                    <code>&lt;swiper&gt;</code>
                </summary>
                <code>&lt;swiper&gt;</code>, <code>&lt;swiper-item&gt;</code>
            </details>            
          </td>
        </tr>
        <tr>
          <th scope="row">Tabs</th>
          <td><a href="https://open-ui.org/components/tabs.research">OpenUI's Tabs</a></td>
          <td>
              <details>
                  <summary>
                      <code>&lt;tabs&gt;</code>
                  </summary>
                  <code>&lt;tabs&gt;</code>, <code>&lt;tab-bar&gt;</code>, <code>&lt;tab-content&gt;</code>
              </details>
          </td>
          <td>
              <details>
                  <summary>
                      <code>&lt;tabs&gt;</code>
                  </summary>
                  <code>&lt;tabs&gt;</code>, <code>&lt;tab-content&gt;</code>
              </details>                        
          </td>
          <td>
              <details>
                  <summary>
                      <code>&lt;tabs&gt;</code>
                  </summary>
                  <code>&lt;tabs&gt;</code>, <code>&lt;tab-item&gt;</code>
              </details>
          </td>
        </tr>
        <tr>
          <th scope="row">Pull to refresh</th>
          <td></td>
          <td><code>&lt;refresh&gt;</code></td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <th scope="row">Icon image</th>
          <td><a href="https://open-ui.org/components/icon.research">OpenUI's icon</a></td>
          <td></td>
          <td><code>&lt;icon&gt;</code></td>
          <td><code>&lt;icon&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">Progress</th>
          <td><code>&lt;progress&gt;</code></td>
          <td><code>&lt;progress&gt;</code></td>
          <td><code>&lt;progress&gt;</code></td>
          <td><code>&lt;progress&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">Link (anchor)</th>
          <td><code>&lt;a&gt;</code></td>
          <td><code>&lt;a&gt;</code></td>
          <td><code>&lt;navigator&gt;</code></td>
          <td><code>&lt;navigator&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">Textual content</th>
          <td>(<code>&lt;cite&gt;</code>, <code>&lt;address&gt;</code>...)</td>
          <td><code>&lt;text&gt;</code></td>
          <td>
              <details>
                  <summary>
                      <code>&lt;text&gt;</code>
                  </summary>
                  <code>&lt;text&gt;</code>, <code>&lt;rich-text&gt;</code>
              </details>
          </td>
          <td>
              <details>
                  <summary>
                      <code>&lt;text&gt;</code>
                  </summary>
                  <code>&lt;text&gt;</code>, <code>&lt;rich-text&gt;</code>
              </details>
          </td>
        </tr>
        <tr>
          <th scope="row">Textual input</th>
          <td><code>&lt;input&gt;</code></td>
          <td><code>&lt;input&gt;</code></td>
          <td><code>&lt;input&gt;</code></td>
          <td><code>&lt;input&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">Image capture input</th>
          <td>
            <details>
                <summary>
                    <code>&lt;input&gt;</code>
                </summary>
                <code>&lt;input type="file" accept="image/*" capture&gt;</code>
            </details>            
          </td>
          <td><code>&lt;camera&gt;</code></td>
          <td></td>
          <td><code>&lt;camera&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">Multiple-line input</th>
          <td><code>&lt;textarea&gt;</code></td>
          <td><code>&lt;textarea&gt;</code></td>
          <td><code>&lt;textarea&gt;</code></td>
          <td><code>&lt;textarea&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">Checkbox</th>
          <td>
              <details>
                  <summary>
                      <code>&lt;input type="checkbox"&gt;</code>
                  </summary>
                  <code>&lt;input type="checkbox"&gt;</code>, OpenUI's <code>&lt;checkbox&gt;</code>
              </details>    
          </td>
          <td><code>&lt;input type="checkbox"&gt;</code></td>
          <td>
              <details>
                  <summary>
                      <code>&lt;checkbox&gt;</code>
                  </summary>
                  <code>&lt;checkbox&gt;</code>, <code>&lt;checkbox-group&gt;</code>
              </details>
          </td>
          <td>
              <details>
                  <summary>
                      <code>&lt;checkbox&gt;</code>
                  </summary>
                  <code>&lt;checkbox&gt;</code>, <code>&lt;checkbox-group&gt;</code>
              </details>
          </td>
        </tr>
        <tr>
          <th scope="row">Radio button</th>
          <td><code>&lt;input type=&quot;radio&quot;&gt;</code></td>
          <td><code>&lt;input type=&quot;radio&quot;&gt;</code></td>
          <td>
              <details>
                  <summary>
                      <code>&lt;radio&gt;</code>
                  </summary>
                  <code>&lt;radio&gt;</code>, <code>&lt;radio-group&gt;</code>
              </details>
          </td>
          <td>
              <details>
                  <summary>
                      <code>&lt;radio&gt;</code>
                  </summary>
                  <code>&lt;radio&gt;</code>, <code>&lt;radio-group&gt;</code>
              </details>
          </td>
        </tr>
        <tr>
          <th scope="row">Form</th>
          <td><code>&lt;form&gt;</code></td>
          <td></td>
          <td><code>&lt;form&gt;</code></td>
          <td><code>&lt;form&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">Button</th>
          <td><code>&lt;button&gt;</code></td>
          <td><code>&lt;input type=&quot;button&quot;&gt;</code></td>
          <td><code>&lt;button&gt;</code></td>
          <td><code>&lt;button&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">Label</th>
          <td><code>&lt;label&gt;</code></td>
          <td><code>&lt;label&gt;</code></td>
          <td><code>&lt;label&gt;</code></td>
          <td><code>&lt;label&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">Select list</th>
            <td>
                <details>
                    <summary>
                        <code>&lt;select&gt;</code>
                    </summary>
                    <code>&lt;select&gt;</code>, <code>&lt;option&gt;</code>, <a href="https://open-ui.org/components/select">OpenUI's select</a>
                </details>
            </td>
            <td>
                <details>
                    <summary>
                        <code>&lt;select&gt;</code>
                    </summary>
                    <code>&lt;select&gt;</code>, <code>&lt;option&gt;</code>
                </details>
            </td>
            <td>
                <details>
                    <summary>
                        <code>&lt;picker&gt;</code>
                    </summary>
                    <code>&lt;picker&gt;</code>, <code>&lt;picker-view&gt;</code>
                </details>
            </td>
            <td>
                <details>
                    <summary>
                        <code>&lt;picker&gt;</code>
                    </summary>
                    <code>&lt;picker&gt;</code>, <code>&lt;picker-view&gt;</code>, <code>&lt;picker-view-column&gt;</code>
                </details>
            </td>
        </tr>
        <tr>
          <th scope="row">Slider</th>
          <td><code>&lt;input&gt;</code></td>
          <td><code>&lt;slider&gt;</code></td>
          <td><code>&lt;slider&gt;</code></td>
          <td><code>&lt;slider&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">Switch button</th>
          <td><a href="https://open-ui.org/components/switch">OpenUI's switch</a></td>
          <td><code>&lt;switch&gt;</code></td>
          <td><code>&lt;switch&gt;</code></td>
          <td><code>&lt;switch&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">Picker</th>
          <td><a href="https://open-ui.org/components/select">OpenUI's select</a></td>
          <td><code>&lt;picker&gt;</code></td>
          <td>
              <details>
                  <summary>
                      <code>&lt;picker&gt;</code>
                  </summary>
                  <code>&lt;picker&gt;</code>, <code>&lt;picker-view&gt;</code>
              </details>
          </td>
          <td>
              <details>
                  <summary>
                      <code>&lt;picker&gt;</code>
                  </summary>
                  <code>&lt;picker&gt;</code>, <code>&lt;picker-view&gt;</code>, <code>&lt;picker-view-column&gt;</code>
              </details>
          </td>
        </tr>
        <tr>
          <th scope="row">Image</th>
          <td><code>&lt;img&gt;</code></td>
          <td><code>&lt;image&gt;</code></td>
          <td><code>&lt;image&gt;</code></td>
          <td><code>&lt;image&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">Audio content</th>
          <td><code>&lt;audio&gt;</code></td>
          <td></td>
          <td></td>
          <td><code>&lt;audio&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">Video content</th>
          <td><code>&lt;video&gt;</code></td>
          <td><code>&lt;video&gt;</code></td>
          <td><code>&lt;video&gt;</code></td>
          <td><code>&lt;video&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">Canvas</th>
          <td><code>&lt;canvas&gt;</code></td>
          <td><code>&lt;canvas&gt;</code></td>
          <td><code>&lt;canvas&gt;</code></td>
          <td><code>&lt;canvas&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">animation</th>
          <td></td>
          <td><code>&lt;lottie&gt;</code></td>
          <td><code>&lt;lottie&gt;</code></td>
          <td>
              <details>
                  <summary>
                      <code>&lt;animation-video&gt;</code>
                  </summary>
                  <code>&lt;animation-video&gt;</code>, <code>&lt;animation-view&gt;</code>
              </details>
          </td>
        </tr>
        <tr>
          <th scope="row">Web-view</th>
          <td><code>&lt;html&gt;</code></td>
          <td><code>&lt;web&gt;</code></td>
          <td><code>&lt;web-view&gt;</code></td>
          <td><code>&lt;web-view&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">Map</th>
          <td></td>
          <td>
            <details>
                <summary>
                    <code>&lt;map&gt;</code>
                </summary>
                <code>&lt;map&gt;</code>, <code>&lt;custommarker&gt;</code>
            </details>            
          </td>
          <td><code>&lt;map&gt;</code></td>
          <td><code>&lt;map&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">Containers list</th>
          <td></td>
          <td>
            <details>
                <summary>
                    <code>&lt;list&gt;</code>
                </summary>
                <code>&lt;list&gt;</code>, <code>&lt;list-item&gt;</code>
            </details>            
          </td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <th scope="row">Pop-up dialog</th>
          <td><code>&lt;dialog&gt;</code></td>
          <td><code>&lt;popup&gt;</code></td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <th scope="row"><abbr title="Real-Time Communications">RTC</abbr>-room</th>
          <td></td>
          <td></td>
          <td></td>
          <td>
              <details>
                  <summary>
                      <code>&lt;rtc-room&gt;</code>
                  </summary>
                  <code>&lt;rtc-room&gt;</code>, <code>&lt;rtc-room-item&gt;</code>
              </details>
          </td>
        </tr>
        <tr>
          <th scope="row">Advertisement</th>
          <td></td>
          <td></td>
          <td></td>
          <td><code>&lt;ad&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">Payment panel</th>
          <td></td>
          <td></td>
          <td></td>
          <td><code>&lt;inline-payment-panel&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">Comment list</th>
          <td></td>
          <td></td>
          <td></td>
          <td>
            <details>
                <summary>
                    <code>&lt;comment-list&gt;</code>
                </summary>
                <code>&lt;comment-list&gt;</code>, <code>&lt;comment-detail&gt;</code>
            </details>            
          </td>
        </tr>
        <tr>
          <th scope="row">Like button</th>
          <td></td>
          <td></td>
          <td></td>
          <td><code>&lt;like&gt;</code></td>
        </tr>
        <tr>
          <th scope="row">Rating panel</th>
          <td></td>
          <td><code>&lt;rating&gt;</code></td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <th scope="row">3D-model</th>
          <td><code>&lt;model&gt;</code> (<abbr title="Work in progress">WIP</abbr>)</td>
          <td></td>
          <td></td>
          <td><code>&lt;modelviewer&gt;</code></td>
        </tr>        
        <tr>
        <th scope="row">marquee</th>
          <td><code>&lt;marquee&gt;</code> (deprecated)</td>
          <td><code>&lt;marquee&gt;</code></td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <th scope="row">Sharing button</th>
          <td></td>
          <td><code>&lt;share-button&gt;</code></td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <th scope="row">Conditional block (media query)</th>
          <td></td>
          <td></td>
          <td><code>&lt;match-media&gt;</code></td>
          <td></td>
        </tr>
        <tr>
          <th scope="row">Page metadata</th>
          <td><code>&lt;meta&gt;</code></td>
          <td></td>
          <td></td>          
          <td><code>&lt;page-meta&gt;</code></td>
        </tr>
      </tbody>
    </table>
  </section>  

  <section class="appendix" id="sec-acknowledgments">
    <h2>Acknowledgments</h2>
    <div class="ednote">List all the contributors and W3C Team contacts</div>
  </section>

</body>

</html>